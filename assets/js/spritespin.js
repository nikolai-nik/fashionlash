(function($){"use strict";var name='spritespin';var Spin={};window.SpriteSpin=Spin;Spin.namespace=name;Spin.mods={};Spin.eventNames=['mousedown','mousemove','mouseup','mouseenter','mouseover','mouseleave','dblclick','mousewheel','touchstart','touchmove','touchend','touchcancel','selectstart','gesturestart','gesturechange','gestureend'];Spin.eventsToPrevent=['dragstart'];Spin.defaults={source:undefined,width:undefined,height:undefined,frames:undefined,framesX:undefined,lanes:1,sizeMode:undefined,module:'360',behavior:'drag',renderer:'canvas',lane:0,frame:0,frameTime:40,animate:true,reverse:false,loop:true,stopFrame:0,wrap:true,wrapLane:false,sense:1,senseLane:undefined,orientation:'horizontal',detectSubsampling:true,scrollThreshold:50,preloadCount:undefined,onInit:undefined,onProgress:undefined,onLoad:undefined,onFrame:undefined,onDraw:undefined};var idCounter=0;var instances={};Spin.instances=instances;function simulateEvent(name,e){for(var id in instances){if(!instances.hasOwnProperty(id))continue;var data=instances[id];var i,module;for(i=0;i<data.mods.length;i+=1){module=data.mods[i];if(typeof module[name]!='function')continue;module[name].apply(data.target,[e,data]);}}}
function bindSimulatedEvent(eName){$(window.document).bind(eName+'.'+ name,function(e){simulateEvent('document'+ eName,e);});}
function handleResizeEvent(){for(var id in instances){if(instances.hasOwnProperty(id)){var data=instances[id];if(data.responsive){Spin.boot(data);}}}}
var resizeTimeout=null;$(window).on('resize',function(){clearTimeout(resizeTimeout);resizeTimeout=setTimeout(handleResizeEvent,100);});for(var i=0;i<Spin.eventNames.length;i+=1){bindSimulatedEvent(Spin.eventNames[i]);}
function pushInstance(data){idCounter+=1;data.id=idCounter;instances[idCounter]=data;}
function popInstance(data){delete instances[data.id];}
function padNumber(num,length,pad){num=String(num);while(num.length<length){num=String(pad)+ num;}
return num;}
function clamp(value,min,max){return(value>max?max:(value<min?min:value));}
Spin.clamp=clamp;function wrap(value,min,max,size){while(value>max){value-=size;}
while(value<min){value+=size;}
return value;}
Spin.wrap=wrap;function prevent(e){e.preventDefault();return false;}
function log(){if(window.console&&window.console.log){window.console.log.apply(window.console,arguments);}}
function bind(target,event,func){if(func){target.bind(event+'.'+ name,function(e){func.apply(target,[e,target.spritespin('data')]);});}}
Spin.bind=bind;function unbind(target){target.unbind('.'+ name);}
function load(opts){var src=(typeof opts.source==='string')?[opts.source]:opts.source;var i,count=0,img,images=[],targetCount=(opts.preloadCount||src.length);var completed=false,firstLoaded=false;var tick=function(){count+=1;if(typeof opts.progress==='function'){opts.progress({index:$.inArray(this,images),loaded:count,total:src.length,percent:Math.round((count/src.length)*100)});}
firstLoaded=firstLoaded||(this===images[0]);if(!completed&&(count>=targetCount)&&firstLoaded&&(typeof opts.complete==='function')){completed=true;opts.complete(images);}};for(i=0;i<src.length;i+=1){img=new Image();images.push(img);img.onload=img.onabort=img.onerror=tick;img.src=src[i];}
if(typeof opts.initiated==='function'){opts.initiated(images);}}
function detectSubsampling(img,size){var iw=(size||img).width;var ih=(size||img).height;if(iw*ih<=1024*1024){return false;}
var canvas;canvas=document.createElement('canvas');if(!canvas||!canvas.getContext){return false;}
var context=canvas.getContext('2d');if(!context){return false;}
canvas.width=canvas.height=1;context.fillStyle="#FF00FF";context.fillRect(0,0,1,1);context.drawImage(img,-iw+ 1,0);try{var dat=context.getImageData(0,0,1,1).data;return(dat[0]===255)&&(dat[1]===0)&&(dat[2]===255);}
catch(err){log(err.message,err.stack);return false;}}
function naturalSize(image){if(image.naturalWidth!=null){return{width:image.naturalWidth,height:image.naturalHeight};}
var img=new Image();img.src=image.src;return{width:img.width,height:img.height};}
function pixelRatio(context){var devicePixelRatio=window.devicePixelRatio||1;var backingStoreRatio=context.webkitBackingStorePixelRatio||context.mozBackingStorePixelRatio||context.msBackingStorePixelRatio||context.oBackingStorePixelRatio||context.backingStorePixelRatio||1;return devicePixelRatio/backingStoreRatio;}
Spin.sourceArray=function(path,opts){var fStart=0,fEnd=0,lStart=0,lEnd=0,digits=opts.digits||2;if(opts.frame){fStart=opts.frame[0];fEnd=opts.frame[1];}
if(opts.lane){lStart=opts.lane[0];lEnd=opts.lane[1];}
var i,j,temp,result=[];for(i=lStart;i<=lEnd;i+=1){for(j=fStart;j<=fEnd;j+=1){temp=path.replace("{lane}",padNumber(i,digits,0));temp=temp.replace("{frame}",padNumber(j,digits,0));result.push(temp);}}
return result;};Spin.measureSource=function(data){var img=data.images[0];var size=naturalSize(img);if(data.images.length===1){data.sourceWidth=size.width;data.sourceHeight=size.height;if(data.detectSubsampling&&detectSubsampling(img,size)){data.sourceWidth/=2;data.sourceHeight/=2;}
data.framesX=data.framesX||data.frames;if(!data.frameWidth||!data.frameHeight){if(data.framesX){data.frameWidth=Math.floor(data.sourceWidth/data.framesX);var framesY=Math.ceil((data.frames*data.lanes)/ data.framesX);
data.frameHeight=Math.floor(data.sourceHeight/framesY);}else{data.frameWidth=size.width;data.frameHeight=size.height;}}}else{data.sourceWidth=data.frameWidth=size.width;data.sourceHeight=data.frameHeight=size.height;if(detectSubsampling(img,size)){data.sourceWidth=data.frameWidth=size.width/2;data.sourceHeight=data.frameHeight=size.height/2;}
data.frames=data.frames||data.images.length;}};Spin.resetInput=function(data){data.startX=data.startY=undefined;data.currentX=data.currentY=undefined;data.oldX=data.oldY=undefined;data.dX=data.dY=data.dW=0;data.ddX=data.ddY=data.ddW=0;};Spin.updateInput=function(e,data){if(e.touches===undefined&&e.originalEvent!==undefined){e.touches=e.originalEvent.touches;}
data.oldX=data.currentX;data.oldY=data.currentY;if(e.touches!==undefined&&e.touches.length>0){data.currentX=e.touches[0].clientX||0;data.currentY=e.touches[0].clientY||0;}else{data.currentX=e.clientX||0;data.currentY=e.clientY||0;}
if(data.oldX===undefined||data.oldY===undefined){data.oldX=data.currentX;data.oldY=data.currentY;}
if(data.startX===undefined||data.startY===undefined){data.startX=data.currentX;data.startY=data.currentY;data.clickframe=data.frame;data.clicklane=data.lane;}
data.dX=data.currentX- data.startX;data.dY=data.currentY- data.startY;data.ddX=data.currentX- data.oldX;data.ddY=data.currentY- data.oldY;data.ndX=data.dX/data.width;data.ndY=data.dY/data.height;data.nddX=data.ddX/data.width;data.nddY=data.ddY/data.height;};Spin.updateFrame=function(data,frame,lane){data.lastFrame=data.frame;data.lastLane=data.lane;if(frame!==undefined){data.frame=Number(frame);}else if(data.animation){data.frame+=(data.reverse?-1:1);}
if(data.animation){data.frame=wrap(data.frame,0,data.frames- 1,data.frames);if(!data.loop&&(data.frame===data.stopFrame)){Spin.stopAnimation(data);}}else if(data.wrap){data.frame=wrap(data.frame,0,data.frames- 1,data.frames);}else{data.frame=clamp(data.frame,0,data.frames- 1);}
if(lane!==undefined){data.lane=lane;if(data.wrapLane){data.lane=wrap(data.lane,0,data.lanes- 1,data.lanes);}else{data.lane=clamp(data.lane,0,data.lanes- 1);}}
if(data.lastFrame!=data.frame||data.lastLane!=data.lane){data.target.trigger("onFrameChanged",data);}
data.target.trigger("onFrame",data);data.target.trigger("onDraw",data);};Spin.stopAnimation=function(data){data.animate=false;if(data.animation){window.clearInterval(data.animation);data.animation=null;}};Spin.setAnimation=function(data){if(data.animate){Spin.requestFrame(data);}else{Spin.stopAnimation(data);}};Spin.requestFrame=function(data){if(data.animation){return;}
if(data.frameFunction===undefined){data.frameFunction=function(){try{Spin.updateFrame(data);}catch(ignore){}};}
data.animation=window.setInterval(data.frameFunction,data.frameTime);};Spin.setModules=function(data){var i,modName,mod;for(i=0;i<data.mods.length;i+=1){modName=data.mods[i];if(typeof modName==='string'){mod=Spin.mods[modName];if(mod){data.mods[i]=mod;}else{$.error("No module found with name "+ modName);}}}};Spin.displaySize=function(data){var w=Math.floor(data.width||data.frameWidth||data.target.innerWidth());var h=Math.floor(data.height||data.frameHeight||data.target.innerHeight());var a=w/h;return{width:w,height:h,aspect:a}}
Spin.calculateInnerLayout=function(data){var w=Math.floor(data.width||data.frameWidth||data.target.innerWidth());var h=Math.floor(data.height||data.frameHeight||data.target.innerHeight());var a=w/h;var w1=data.frameWidth||w;var h1=data.frameHeight||h;var a1=w1/h1;var css={width:'100%',height:'100%',top:0,left:0,bottom:0,right:0,position:'absolute',overflow:'hidden'};var mode=data.sizeMode;if(!mode||mode=='scale'){return css;}
if(mode=='original'){css.width=w1;css.height=h1;}else if(mode=='fit'){if(a1>=a){css.width=w;css.height=w/a1;}else{css.height=h;css.width=h*a1;}}else if(mode=='fill'){if(a1>=a){css.height=h;css.width=h*a1;}else{css.width=w;css.height=w/a1;}}else{css.width=w;css.height=h;}
css.width=css.width|0;css.height=css.height|0;css.top=((h- css.height)/ 2)|0;
css.left=((w- css.width)/ 2)|0;
css.right=css.left;css.bottom=css.top;return css;};Spin.setLayout=function(data){data.target.attr('unselectable','on').css({width:'',height:'','-ms-user-select':'none','-moz-user-select':'none','-khtml-user-select':'none','-webkit-user-select':'none','user-select':'none'});var w=Math.floor(data.width||data.frameWidth||data.target.innerWidth());var h=Math.floor(data.height||data.frameHeight||data.target.innerHeight());if(data.responsive&&(typeof window.getComputedStyle==='function')){var style=getComputedStyle(data.target[0]);if(style.width){var a=w/h;w=Number(style.width.replace('px',''))|0;h=(w/a)|0;}}
data.target.css({width:w,height:h,position:'relative',overflow:'hidden'});var css=Spin.calculateInnerLayout(data);data.stage.css(css).hide();if(data.canvas){data.canvasRatio=data.canvasRatio||pixelRatio(data.context);data.canvas[0].width=(css.width*data.canvasRatio)||w;data.canvas[0].height=(css.height*data.canvasRatio)||h;data.canvas.css(css).hide();data.context.scale(data.canvasRatio,data.canvasRatio);}};Spin.setEvents=function(data){var i,j,mod,target=data.target;unbind(target);for(j=0;j<Spin.eventsToPrevent.length;j+=1){bind(target,Spin.eventsToPrevent[j],prevent);}
for(i=0;i<data.mods.length;i+=1){mod=data.mods[i];for(j=0;j<Spin.eventNames.length;j+=1){bind(target,Spin.eventNames[j],mod[Spin.eventNames[j]]);}
bind(target,'onInit',mod.onInit);bind(target,'onProgress',mod.onProgress);bind(target,'onLoad',mod.onLoad);bind(target,'onFrameChanged',mod.onFrameChanged);bind(target,'onFrame',mod.onFrame);bind(target,'onDraw',mod.onDraw);}
bind(target,'onLoad',function(e,data){Spin.setAnimation(data);});bind(target,'onInit',data.onInit);bind(target,'onProgress',data.onProgress);bind(target,'onLoad',data.onLoad);bind(target,'onFrameChanged',mod.onFrameChanged);bind(target,'onFrame',data.onFrame);bind(target,'onDraw',data.onDraw);};Spin.boot=function(data){Spin.setModules(data);Spin.setLayout(data);Spin.setEvents(data);data.target.addClass('loading').trigger('onInit',data);data.loading=true;load({source:data.source,preloadCount:data.preloadCount,progress:function(progress){data.target.trigger('onProgress',[progress,data]);},complete:function(images){data.images=images;data.loading=false;Spin.measureSource(data);Spin.setLayout(data);data.stage.show();data.target.removeClass('loading').trigger('onLoad',data).trigger('onFrame',data).trigger('onDraw',data);}});};Spin.create=function(options){var $this=options.target;var data=$this.data(name);if(!data){data=$.extend({},Spin.defaults,options);data.source=data.source||[];$this.find('img').each(function(){data.source.push($(this).attr('src'));});$this.empty().addClass("spritespin-instance").append("<div class='spritespin-stage'></div>");if(data.renderer==='canvas'){var canvas=$("<canvas class='spritespin-canvas'></canvas>")[0];if(!!(canvas.getContext&&canvas.getContext('2d'))){data.canvas=$(canvas);data.context=canvas.getContext("2d");$this.append(data.canvas);$this.addClass('with-canvas');}else{data.renderer='image';}}
data.target=$this;data.stage=$this.find(".spritespin-stage");$this.data(name,data);pushInstance(data);}else{$.extend(data,options);}
if(typeof data.source==='string'){data.source=[data.source];}
if(data.mods){delete data.behavior;delete data.module;}
if(data.behavior||data.module){data.mods=[];if(data.behavior){data.mods.push(data.behavior);}
if(data.module){data.mods.push(data.module);}
delete data.behavior;delete data.module;}
Spin.boot(data);};Spin.destroy=function(data){if(data){popInstance(data);Spin.stopAnimation(data);unbind(data.target);data.target.removeData(name);}};Spin.registerModule=function(name,module){if(Spin.mods[name]){$.error('Module name is already taken: '+ name);}
module=module||{};Spin.mods[name]=module;return module;};Spin.Api=function(data){this.data=data;};Spin.extendApi=function(methods){var key,api=Spin.Api.prototype;for(key in methods){if(methods.hasOwnProperty(key)){if(api[key]){$.error('API method is already defined: '+ key);}else{api[key]=methods[key];}}}
return api;};$.fn.spritespin=function(obj,value){if(obj==="data"){return this.data(name);}
if(obj==="api"){var data=this.data(name);data.api=data.api||new Spin.Api(data);return data.api;}
if(obj==="destroy"){return $(this).each(function(){Spin.destroy($(this).data(name));});}
if(arguments.length===2&&typeof obj==='string'){var tmp={};tmp[obj]=value;obj=tmp;}
if(typeof obj==='object'){obj.target=obj.target||$(this);Spin.create(obj);return obj.target;}
return $.error('Invalid call to spritespin');};}(window.jQuery||window.Zepto||window.$));(function($){"use strict";var SpriteSpin=window.SpriteSpin;SpriteSpin.extendApi({isPlaying:function(){return this.data.animation!==null;},isLooping:function(){return this.data.loop;},toggleAnimation:function(){this.data.animate=!this.data.animate;SpriteSpin.setAnimation(this.data);},stopAnimation:function(){this.data.animate=false;SpriteSpin.setAnimation(this.data);},startAnimation:function(){this.data.animate=true;SpriteSpin.setAnimation(this.data);},loop:function(value){this.data.loop=value;SpriteSpin.setAnimation(this.data);return this;},currentFrame:function(){return this.data.frame;},updateFrame:function(frame){SpriteSpin.updateFrame(this.data,frame);return this;},skipFrames:function(step){var data=this.data;SpriteSpin.updateFrame(data,data.frame+(data.reverse?- step:+ step));return this;},nextFrame:function(){return this.skipFrames(1);},prevFrame:function(){return this.skipFrames(-1);},playTo:function(frame,options){var data=this.data;options=options||{};if(!options.force&&data.frame===frame){return;}
if(options.nearest){var a=frame- data.frame;var b=frame>data.frame?a- data.frames:a+ data.frames;var c=Math.abs(a)<Math.abs(b)?a:b;data.reverse=c<0;}
data.animate=true;data.loop=false;data.stopFrame=frame;SpriteSpin.setAnimation(data);return this;}});}(window.jQuery||window.Zepto||window.$));(function($){"use strict";var fn=(function(){var val;var valLength;var fnMap=[['requestFullscreen','exitFullscreen','fullscreenElement','fullscreenEnabled','fullscreenchange','fullscreenerror'],['webkitRequestFullscreen','webkitExitFullscreen','webkitFullscreenElement','webkitFullscreenEnabled','webkitfullscreenchange','webkitfullscreenerror'],['webkitRequestFullScreen','webkitCancelFullScreen','webkitCurrentFullScreenElement','webkitCancelFullScreen','webkitfullscreenchange','webkitfullscreenerror'],['mozRequestFullScreen','mozCancelFullScreen','mozFullScreenElement','mozFullScreenEnabled','mozfullscreenchange','mozfullscreenerror'],['msRequestFullscreen','msExitFullscreen','msFullscreenElement','msFullscreenEnabled','MSFullscreenChange','MSFullscreenError']];var i=0;var l=fnMap.length;var ret={};for(;i<l;i++){val=fnMap[i];if(val&&val[1]in document){for(i=0,valLength=val.length;i<valLength;i++){ret[fnMap[0][i]]=val[i];}
return ret;}}
return false;})();function requestFullscreen(e){e=e||document.documentElement;e[fn.requestFullscreen]();}
function exitFullscreen(){return document[fn.exitFullscreen]();}
function fullscreenEnabled(){return document[fn.fullscreenEnabled];}
function fullscreenElement(){return document[fn.fullscreenElement];}
function isFullscreen(){return!!fullscreenElement();}
var changeEvent=fn.fullscreenchange+'.'+ SpriteSpin.namespace+'-fullscreen';function unbindChangeEvent(){$(document).unbind(changeEvent);}
function bindChangeEvent(callback){unbindChangeEvent();$(document).bind(changeEvent,callback);}
var orientationEvent='orientationchange.'+ SpriteSpin.namespace+'-fullscreen';function unbindOrientationEvent(){$(window).unbind(orientationEvent)}
function bindOrientationEvent(callback){unbindOrientationEvent()
$(window).bind(orientationEvent,callback);}
SpriteSpin.extendApi({fullscreenEnabled:fullscreenEnabled,fullscreenElement:fullscreenElement,exitFullscreen:exitFullscreen,toggleFullscreen:function(opts){if(isFullscreen()){this.requestFullscreen(opts)}else{this.exitFullscreen()}},requestFullscreen:function(opts){opts=opts||{};var api=this;var data=api.data;var oWidth=data.width;var oHeight=data.height;var oSource=data.source;var oSize=data.sizeMode;var oResponsive=data.responsive;var enter=function(){data.width=window.screen.width;data.height=window.screen.height;data.source=opts.source||oSource;data.sizeMode=opts.sizeMode||'fit';data.responsive=false;SpriteSpin.boot(data);}
var exit=function(){data.width=oWidth;data.height=oHeight;data.source=oSource;data.sizeMode=oSize;data.responsive=oResponsive;SpriteSpin.boot(data);}
bindChangeEvent(function(){if(isFullscreen()){enter();bindOrientationEvent(enter);}else{unbindChangeEvent();unbindOrientationEvent();exit();}});requestFullscreen(data.target[0]);}});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";function click(e,data){if(data.loading||!data.stage.is(':visible'))return;SpriteSpin.updateInput(e,data);var half,pos,target=data.target,offset=target.offset();if(data.orientation==="horizontal"){half=target.innerWidth()/ 2;
pos=data.currentX- offset.left;}else{half=target.innerHeight()/ 2;
pos=data.currentY- offset.top;}
SpriteSpin.updateFrame(data,data.frame+(pos>half?1:-1));}
SpriteSpin.registerModule('click',{mouseup:click,touchend:click});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";function dragStart(e,data){if(data.loading||data.dragging||!data.stage.is(':visible'))return;data.dragFrame=data.frame||0;data.dragLane=data.lane||0;data.dragging=true;SpriteSpin.updateInput(e,data);}
function dragEnd(e,data){if(data.dragging){data.dragging=false;SpriteSpin.resetInput(data);}}
function drag(e,data){if(!data.dragging)return;SpriteSpin.updateInput(e,data);if((Math.abs(data.ddX)+ Math.abs(data.ddY))>data.scrollThreshold){data.dragging=false;SpriteSpin.resetInput(data);return;}
e.preventDefault();var angle=0;if(typeof data.orientation==='number'){angle=(Number(data.orientation)||0)*Math.PI/180;}else if(data.orientation==='horizontal'){angle=0;}else{angle=Math.PI/2;}
var sn=Math.sin(angle);var cs=Math.cos(angle);var x=((data.nddX*cs- data.nddY*sn)*data.sense)||0;var y=((data.nddX*sn+ data.nddY*cs)*(data.senseLane||data.sense))||0;data.dragFrame+=data.frames*x;data.dragLane+=data.lanes*y;var frame=Math.floor(data.dragFrame);var lane=Math.floor(data.dragLane);SpriteSpin.updateFrame(data,frame,lane);SpriteSpin.stopAnimation(data);}
SpriteSpin.registerModule('drag',{mousedown:dragStart,mousemove:drag,mouseup:dragEnd,documentmousemove:drag,documentmouseup:dragEnd,touchstart:dragStart,touchmove:drag,touchend:dragEnd,touchcancel:dragEnd});SpriteSpin.registerModule('move',{mousemove:function(e,data){dragStart.call(this,e,data);drag.call(this,e,data);},mouseleave:dragEnd,touchstart:dragStart,touchmove:drag,touchend:dragEnd,touchcancel:dragEnd});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";function start(e,data){if(data.loading||data.dragging||!data.stage.is(':visible'))return;SpriteSpin.updateInput(e,data);data.dragging=true;data.animate=true;SpriteSpin.setAnimation(data);}
function stop(e,data){data.dragging=false;SpriteSpin.resetInput(data);SpriteSpin.stopAnimation(data);}
function update(e,data){if(!data.dragging)return;SpriteSpin.updateInput(e,data);var half,delta,target=data.target,offset=target.offset();if(data.orientation==="horizontal"){half=target.innerWidth()/ 2;
delta=(data.currentX- offset().left- half)/ half;
}else{half=(data.height/2);delta=(data.currentY- offset().top- half)/ half;
}
data.reverse=delta<0;delta=delta<0?-delta:delta;data.frameTime=80*(1- delta)+ 20;if(((data.orientation==='horizontal')&&(data.dX<data.dY))||((data.orientation==='vertical')&&(data.dX<data.dY))){e.preventDefault();}}
SpriteSpin.registerModule('hold',{mousedown:start,mousemove:update,mouseup:stop,mouseleave:stop,touchstart:start,touchmove:update,touchend:stop,touchcancel:stop,onFrame:function(){$(this).spritespin("api").startAnimation();}});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";function init(e,data){data.swipeFling=data.swipeFling||10;data.swipeSnap=data.swipeSnap||0.50;}
function start(e,data){if(!data.loading&&!data.dragging){SpriteSpin.updateInput(e,data);data.dragging=true;}}
function update(e,data){if(!data.dragging)return;SpriteSpin.updateInput(e,data);var frame=data.frame;var lane=data.lane;SpriteSpin.updateFrame(data,frame,lane);}
function end(e,data){if(!data.dragging)return;data.dragging=false;var frame=data.frame;var lane=data.lane;var snap=data.swipeSnap;var fling=data.swipeFling;var dS,dF;if(data.orientation==="horizontal"){dS=data.ndX;dF=data.ddX;}else{dS=data.ndY;dF=data.ddY;}
if(dS>snap||dF>fling){frame=data.frame- 1;}else if(dS<-snap||dF<-fling){frame=data.frame+ 1;}
SpriteSpin.resetInput(data);SpriteSpin.updateFrame(data,frame,lane);SpriteSpin.stopAnimation(data);}
SpriteSpin.registerModule('swipe',{onLoad:init,mousedown:start,mousemove:update,mouseup:end,mouseleave:end,touchstart:start,touchmove:update,touchend:end,touchcancel:end});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";var floor=Math.floor;function drawSprite(data){var index=data.lane*data.frames+ data.frame;var x=data.frameWidth*(index%data.framesX);var y=data.frameHeight*floor(index/data.framesX);if(data.renderer==='canvas'){var w=data.canvas[0].width/data.canvasRatio;var h=data.canvas[0].height/data.canvasRatio;data.context.clearRect(0,0,w,h);data.context.drawImage(data.images[0],x,y,data.frameWidth,data.frameHeight,0,0,w,h);return;}
x=-floor(x*data.scaleWidth);y=-floor(y*data.scaleHeight);if(data.renderer==='background'){data.stage.css({"background-image":["url('",data.source[0],"')"].join(""),"background-position":[x,"px ",y,"px"].join("")});}else{$(data.images).css({top:y,left:x,"max-width":'initial'});}}
function drawFrames(data){var index=data.lane*data.frames+ data.frame;var img=data.images[index];if(data.renderer==='canvas'){if(img&&img.complete!==false){var w=data.canvas[0].width/data.canvasRatio;var h=data.canvas[0].height/data.canvasRatio;data.context.clearRect(0,0,w,h);data.context.drawImage(img,0,0,w,h);}}else if(data.renderer==='background'){data.stage.css({"background-image":["url('",data.source[index],"')"].join(""),"background-position":[0,"px ",0,"px"].join("")});}else{$(data.images).hide();$(data.images[index]).show();}}
SpriteSpin.registerModule('360',{onLoad:function(e,data){var w,h;if(data.width&&data.frameWidth){data.scaleWidth=data.width/data.frameWidth;}else{data.scaleWidth=1;}
if(data.height&&data.frameHeight){data.scaleHeight=data.height/data.frameHeight;}else{data.scaleHeight=1;}
data.sourceIsSprite=data.images.length===1;data.stage.empty().css({"background-image":'none'}).show();if(data.renderer==='canvas')
{var w=data.canvas[0].width/data.canvasRatio;var h=data.canvas[0].height/data.canvasRatio;data.context.clearRect(0,0,w,h);data.canvas.show();}
else if(data.renderer==='background')
{if(data.sourceIsSprite){w=floor(data.sourceWidth*data.scaleWidth);h=floor(data.sourceHeight*data.scaleHeight);}else{w=floor(data.frameWidth*data.scaleWidth);h=floor(data.frameHeight*data.scaleHeight);}
var background=[w,"px ",h,"px"].join("");data.stage.css({"background-repeat":"no-repeat","-webkit-background-size":background,"-moz-background-size":background,"-o-background-size":background,"background-size":background});}
else if(data.renderer==='image')
{if(data.sourceIsSprite){w=floor(data.sourceWidth*data.scaleWidth);h=floor(data.sourceHeight*data.scaleHeight);}else{w=h='100%';}
$(data.images).appendTo(data.stage).css({width:w,height:h,position:'absolute'});}},onDraw:function(e,data){if(data.sourceIsSprite){drawSprite(data);}else{drawFrames(data);}}});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";function init(e,data){var scope=scopeFrom(data);var css=SpriteSpin.calculateInnerLayout(data);scope.canvas[0].width=data.width*data.canvasRatio;scope.canvas[0].height=data.height*data.canvasRatio;scope.canvas.css(css).show();scope.context.scale(data.canvasRatio,data.canvasRatio);data.target.append(scope.canvas);}
function destroy(e,data){var scope=scopeFrom(data)
data.target.remove(data)
delete data.blurScope}
function onFrame(e,data){var scope=scopeFrom(data);trackFrame(data,scope)
if(scope.timeout==null)loop(data,scope);}
function scopeFrom(data){data.blurScope=data.blurScope||{};var scope=data.blurScope;scope.canvas=scope.canvas||$("<canvas class='blur-layer'></canvas>");scope.context=scope.context||scope.canvas[0].getContext("2d");scope.steps=scope.steps||[];scope.fadeTime=Math.max(data.blurFadeTime||200,1);scope.frameTime=Math.max(data.blurFrameTime||data.frameTime,16);scope.trackTime=null;scope.cssBlur=!!data.blurCss;return scope;}
function trackFrame(data,scope){var d=Math.abs(data.frame- data.lastFrame);if(d>=data.frames/2)d=data.frames- d;scope.steps.unshift({index:data.lane*data.frames+ data.frame,live:1,step:scope.frameTime/scope.fadeTime,d:d});}
var toRemove=[]
function removeOldFrames(frames){toRemove.length=0;var i;for(i=0;i<frames.length;i+=1){if(frames[i].alpha<=0)toRemove.push(i);}
for(i=0;i<toRemove.length;i+=1){frames.splice(toRemove[i],1);}}
function loop(data,scope){scope.timeout=window.setTimeout(function(){tick(data,scope);},scope.frameTime);}
function killLoop(data,scope){window.clearTimeout(scope.timeout);scope.timeout=null;}
function applyCssBlur(canvas,d){d=Math.min(Math.max((d/2)- 4,0),1.5);canvas.css({'-webkit-filter':'blur('+ d+'px)','filter':'blur('+ d+'px)'});}
function drawFrame(data,scope,step){var context=scope.context;var index=step.index;var img=(data.sourceIsSprite?data.images[0]:data.images[index]);if(step.alpha<=0)return;if(!img||img.complete===false)return
context.globalAlpha=step.alpha;if(data.sourceIsSprite){var x=data.frameWidth*(index%data.framesX);var y=data.frameHeight*Math.floor(index/data.framesX);context.drawImage(img,x,y,data.frameWidth,data.frameHeight,0,0,data.width,data.height);}else{context.drawImage(img,0,0,data.width,data.height);}}
function tick(data,scope){killLoop(data,scope);if(!scope.context)return;var i,step,context=scope.context,d=0;context.clearRect(0,0,data.width,data.height);for(i=0;i<scope.steps.length;i+=1){step=scope.steps[i];step.live=Math.max(step.live- step.step,0);step.alpha=Math.max(step.live- 0.25,0);drawFrame(data,scope,step);d+=step.alpha+ step.d;}
if(scope.cssBlur){applyCssBlur(scope.canvas,d)}
removeOldFrames(scope.steps);if(scope.steps.length){loop(data,scope);}}
SpriteSpin.registerModule('blur',{onLoad:init,onFrameChanged:onFrame});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";var max=Math.max
var min=Math.min
function init(e,data){data.easeAbortAfterMs=max(data.easeAbortAfterMs||250,0);data.easeDamping=max(min(data.easeDamping||0.9,0.999),0);data.easeSamples=max(data.easeSamples||5,1);data.easeUpdateTime=max(data.easeUpdateTime||data.frameTime,16);data.easeScope={samples:[],steps:[]};}
function update(e,data){if(data.dragging){killLoop(data,data.easeScope);sampleInput(data,data.easeScope);}}
function end(e,data){var ease=data.easeScope;var last,sample,samples=ease.samples;var lanes=0,frames=0,time=0;for(var i=0;i<samples.length;i+=1){sample=samples[i];if(!last){last=sample;continue}
var dt=sample.time- last.time;if(dt>data.easeAbortAfterMs){lanes=frames=time=0;return killLoop(data,ease);}
frames+=sample.frame- last.frame;lanes+=sample.lane- last.lane;time+=dt;last=sample;}
samples.length=0;if(!time){return}
ease.ms=data.easeUpdateTime;ease.lane=data.lane;ease.lanes=0;ease.laneStep=lanes/time*ease.ms;ease.frame=data.frame;ease.frames=0;ease.frameStep=frames/time*ease.ms;loop(data,ease);}
function sampleInput(data,ease){ease.samples.push({time:new Date().getTime(),frame:data.dragFrame,lane:data.dragLane});while(ease.samples.length>data.easeSamples){ease.samples.shift();}}
function killLoop(data,ease){if(ease.timeout!=null){window.clearTimeout(ease.timeout);ease.timeout=null;}}
function loop(data,ease){ease.timeout=window.setTimeout(function(){tick(data,ease);},ease.ms);}
function tick(data,ease){ease.lanes+=ease.laneStep;ease.frames+=ease.frameStep;ease.laneStep*=data.easeDamping;ease.frameStep*=data.easeDamping;var frame=Math.floor(ease.frame+ ease.frames);var lane=Math.floor(ease.lane+ ease.lanes);SpriteSpin.updateFrame(data,frame,lane);if(data.dragging){killLoop(data,ease);}else if(Math.abs(ease.frameStep)>0.005||Math.abs(ease.laneStep)>0.005){loop(data,ease);}else{killLoop(data,ease);}}
SpriteSpin.registerModule('ease',{onLoad:init,mousemove:update,mouseup:end,mouseleave:end,touchmove:update,touchend:end,touchcancel:end});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";function load(e,data){data.galleryImages=[];data.galleryOffsets=[];data.gallerySpeed=500;data.galleryOpacity=0.25;data.galleryFrame=0;data.galleryStage=data.galleryStage||$('<div/>');data.stage.prepend(data.galleryStage);data.galleryStage.empty();var size=0,i;for(i=0;i<data.source.length;i+=1){var img=$("<img src='"+ data.source[i]+"'/>");data.galleryStage.append(img);data.galleryImages.push(img);var scale=data.height/img[0].height;data.galleryOffsets.push(-size+(data.width- img[0].width*scale)/ 2);
size+=data.width;img.css({"max-width":'initial',opacity:data.galleryOpacity,width:data.width,height:data.height});}
var css=SpriteSpin.calculateInnerLayout(data);data.galleryStage.css(css).css({width:size});data.galleryImages[data.galleryFrame].animate({opacity:1},data.gallerySpeed);}
function draw(e,data){if(data.galleryFrame!==data.frame&&!data.dragging){data.galleryStage.stop(true,false);data.galleryStage.animate({"left":data.galleryOffsets[data.frame]},data.gallerySpeed);data.galleryImages[data.galleryFrame].animate({opacity:data.galleryOpacity},data.gallerySpeed);data.galleryFrame=data.frame;data.galleryImages[data.galleryFrame].animate({opacity:1},data.gallerySpeed);}else if(data.dragging||data.dX!=data.gallerydX){data.galleryDX=data.DX;data.galleryDDX=data.DDX;data.galleryStage.stop(true,true).animate({"left":data.galleryOffsets[data.frame]+ data.dX});}}
SpriteSpin.registerModule('gallery',{onLoad:load,onDraw:draw});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";var floor=Math.floor;SpriteSpin.registerModule('panorama',{onLoad:function(e,data){data.stage.empty().show();data.frames=data.sourceWidth;if(data.orientation==="horizontal"){data.scale=data.height/data.sourceHeight;data.frames=data.sourceWidth;}else{data.scale=data.width/data.sourceWidth;data.frames=data.sourceHeight;}
var w=floor(data.sourceWidth*data.scale);var h=floor(data.sourceHeight*data.scale);var background=[w,"px ",h,"px"].join("");data.stage.css({"max-width":'initial',"background-image":["url('",data.source[0],"')"].join(""),"background-repeat":"repeat-both","-webkit-background-size":background,"-moz-background-size":background,"-o-background-size":background,"background-size":background});},onDraw:function(e,data){var x=0,y=0;if(data.orientation==="horizontal"){x=-floor((data.frame%data.frames)*data.scale);}else{y=-floor((data.frame%data.frames)*data.scale);}
data.stage.css({"background-position":[x,"px ",y,"px"].join("")});}});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));(function($,SpriteSpin){"use strict";function onCreate(e,data){if(data.zoomStage)return
data.zoomStage=$("<div class='spritezoom-stage'></div>").css({width:'100%',height:'100%',top:0,left:0,bottom:0,right:0,position:'absolute'}).appendTo(data.target).hide();}
function onDestroy(e,data){if(!data.zoomStage)return
data.zoomStage.remove()}
function updateInput(e,data){e.preventDefault();data.dragging=false;if(!e.touches&&e.originalEvent){e.touches=e.originalEvent.touches;}
var x,y,dx,dy;if(e.touches&&e.touches.length){x=e.touches[0].clientX||0;y=e.touches[0].clientY||0;}else{x=e.clientX||0;y=e.clientY||0;}
x/=data.width;y/=data.height;if(data.zoomPX==null){data.zoomPX=x;data.zoomPY=y;}
if(data.zoomX==null){data.zoomX=x;data.zoomY=y;}
dx=x- data.zoomPX;dy=y- data.zoomPY;data.zoomPX=x;data.zoomPY=y;if(e.type.match(/touch/)){dx=-dx;dy=-dy;}
data.zoomX=SpriteSpin.clamp(data.zoomX+ dx,0,1);data.zoomY=SpriteSpin.clamp(data.zoomY+ dy,0,1);SpriteSpin.updateFrame(data);}
function onDraw(e,data){var index=data.lane*data.frames+ data.frame;var source=(data.zoomSource||data.source)[index];if(!source){$.error("'zoomSource' option is missing or it contains unsufficient number of frames.")
return;}
var x=data.zoomX;var y=data.zoomY;if(x==null||y==null){x=data.zoomX=0.5;y=data.zoomY=0.5;}
x=(x*100)|0;y=(y*100)|0;data.zoomStage.css({"background-repeat":"no-repeat","background-image":["url('",source,"')"].join(""),"background-position":[x,"% ",y,"%"].join("")});}
function onClick(e,data){e.preventDefault();var clickTime=new Date().getTime();if(!data.zoomClickTime){data.zoomClickTime=clickTime;return;}
var timeDelta=clickTime- data.zoomClickTime;var doubleClickTime=data.zoomDoubleClickTime||500;if(timeDelta>doubleClickTime){data.zoomClickTime=clickTime;return;}
data.zoomClickTime=0;if($(this).spritespin('api').toggleZoom()){updateInput(e,data);}}
function onMove(e,data){if(!data.zoomStage.is(':visible'))return;updateInput(e,data);}
function toggleZoom(){var data=this.data;if(!data.zoomStage){$.error('zoom module is not initialized or is not available.');return false;}
if(data.zoomStage.is(':visible')){data.zoomStage.fadeOut();data.stage.fadeIn();}else{data.zoomStage.fadeIn();data.stage.fadeOut();return true;}
return false;}
SpriteSpin.registerModule('zoom',{mousedown:onClick,touchstart:onClick,mousemove:onMove,touchmove:onMove,onInit:onCreate,onDestroy:onDestroy,onDraw:onDraw});SpriteSpin.extendApi({toggleZoom:toggleZoom});}(window.jQuery||window.Zepto||window.$,window.SpriteSpin));